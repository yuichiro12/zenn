---
title: "整数問題（1）"
emoji: "🐇"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["整数", "数列", "力学系"]
published: true
---

$M$ を自然数（正の整数）の定数とする． $M$ の $1$ の位を $b_1$ とし， $a_1 = M - b_1$ と定める．以降，自然数 $n$ に対して， $\displaystyle \frac{a_n}{10} + 7b_n$ の $1$ の位を $b_{n+1}$ とし， $\displaystyle a_{n+1} = \frac{a_n}{10} + 7b_n - b_{n+1}$ とするとき，次の問いに答えよ．

（$1$） 全ての自然数 $n$ に対して， $a_n + b_n = M$ となるような $M$ を全て求めよ．
（$2$） $M = 1$ とするとき， $a_{23} + b_{23}$ を求めよ．
（$3$） $M = 22^{2022}$ とするとき， $a_{10000} + b_{10000}$ を求めよ．

:::details ヒント ❔
（$1$） $3$ つあります．必要性から考えましょう．

（$2$） 直接計算できる範囲なので計算してみましょう．

（$3$） この数列の性質として，（$1$）で不動点，（$2$）で周期性を見てきました．実は一般に，$a_{n+22} + b_{n+22} \equiv a_n + b_n \pmod {69}$　が成り立ちます．これを示してみましょう．
:::

:::details 解答 ✅

（$1$） 全ての自然数 $n$ に対して， $b_n$ は $1$ 桁の整数であり， $a_n$ は帰納的に $10$ の倍数となるので， $a_k + b_k = M$ ならば， $a_k = a_1$ ， $b_k = b_1$ である．
したがって条件より $a_{n+1} = a_n = a_1$，$b_{n+1} = b_n = b_1$ である．これを漸化式に代入して整理すると，$3a_1 = 20b_1$ を得る．
$b_1$ は $1$ 桁の整数なので，$(a_1, b_1) = (0, 0), (20, 3), (40, 6), (60, 9)$ である．
このうち $(a_1, b_1) = (0, 0)$ は，$M = 0$ となるので不適．よって，$M = 23, 46, 69$ ．

<br/>

（$2$） 下記の表より，$a_{23} + b_{23} = 1$．

| $n$       | $1$ | $2$ | $3$  | $4$  | $5$  | $6$  | $7$ | $8$  | $9$  | $10$ | $11$ | $12$ | $13$ | $14$ | $15$ | $16$ | $17$ | $18$ | $19$ | $20$ | $21$ | $22$ | $23$ |
| --------- | --- | --- | ---- | ---- | ---- | ---- | --- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- |
| $a_n+b_n$ | $1$ | $7$ | $49$ | $67$ | $55$ | $40$ | $4$ | $28$ | $58$ | $61$ | $13$ | $22$ | $16$ | $43$ | $25$ | $37$ | $52$ | $19$ | $64$ | $34$ | $31$ | $10$ | $1$  |

<br/>

（$3$）　$10 \equiv 1 \pmod 3$ であるから， $10^{22} \equiv 1 \pmod 3$ であり，また，フェルマーの小定理より， $10^{22} \equiv 1 \pmod {23}$ であるので，中国剰余定理より， $$10^{22} \equiv 1 \pmod {69}  \cdots ①$$ を得る．ところで，与式を変形すると，
$$\displaystyle 10(a_{n+1} + b_{n+1}) = a_n + b_n + 69b_n  \cdots ②$$ が得られるので，帰納的に，
$$\displaystyle 10^{22}(a_{n+22} + b_{n+22}) = a_n + b_n + 69\sum_{i = 0}^{21}10^i b_{n+i}$$ である． $a_n,  b_n$は整数であるから，これと$①$より， $$\displaystyle a_{n+22} + b_{n+22} \equiv a_n + b_n \pmod {69}$$が成り立つ．したがって $$a_{22n + 1} + b_{22n + 1} \equiv 22^{2022} \pmod {69} \cdots ③$$ である．　$22 \equiv 1 \pmod{3}$ および $22 \equiv -1 \pmod{23}$ より，中国剰余定理から， $$22^{2022} \equiv 1 \pmod{69}$$ $9989 \equiv 1 \pmod {22}$ であるので，$③$より， $$a_{9989} + b_{9989} \equiv 1 \pmod {69}  \cdots ④$$

次に，$a_{9989}+b_{9989} \leq 69$ を示す．再び$②$より帰納的に， $$\displaystyle 10^{n-1}(a_n + b_n) = M + 69\sum_{i = 1}^{n-1}10^{i-1} b_{i}$$ であるから， $0 \leq b_n \leq 9$ であることに注意して，　 $$\begin{aligned}\displaystyle a_n + b_n  &= \frac{M}{10^{n-1}} + 69\sum_{i = 1}^{n-1}10^{i-n} b_{i} \\ &\leq \frac{M}{10^{n-1}} + 69\sum_{i = 1}^{n-1} 10^{i-n} \cdot 9 \\ &= \frac{M}{10^{n-1}} + 69\{1-(\frac{1}{10})^{n-1}\} \\ &< \frac{M}{10^{n-1}} + 69 \end{aligned}$$ これより， $M = 22^{2022}, n=9989$ を代入して， $$a_{9989}+b_{9989} < \frac{22^{2022}}{100^{4994}}+69 < 70$$
$a_{9989}+b_{9989}$ は自然数であるから，$a_{9989}+b_{9989} \leq 69$　である．これと$④$より， $a_{9989} + b_{9989} = 1$ である．したがって（$2$）の表より， $a_{10000} + b_{10000} = 22$ ． $\square$
:::

:::details コメント 💬
[2015 JMO 予選($10$)](https://www.imojp.org/archive/mo2015/jmo2015/problems/jmo25yq.html)　の改題です．
どのような自然数 $M$ から出発しても，一定の周期の中に吸い込まれていくブラックホールみたいな数列ですね．

ちなみに（$2$）で気付いた方もいると思いますが，周期表に出現する数は全て $3$ で割って $1$ 余る数になっています．つまり， $M = 2$，$M = 3$ などから出発した場合，$a_n+b_n \pmod{69}$ の周期はいずれも同じ $22$ になりますが，（$2$）の解答にある周期表とは全く別の周期表になります．ちょっと初期値がズレただけでその後は全く別の道をたどり，生涯巡り合うことはないのですね．

証明してはいないのですが，性質から考えると，この数列の$69$以下の領域は[アトラクター](https://ja.wikipedia.org/wiki/%E3%82%A2%E3%83%88%E3%83%A9%E3%82%AF%E3%82%BF%E3%83%BC#%E5%AE%9A%E7%BE%A9%E3%81%A8%E4%B8%80%E8%88%AC%E7%9A%84%E6%80%A7%E8%B3%AA)の定義を満たすような気がします．そのうち気が向いたらやってみます．
:::
